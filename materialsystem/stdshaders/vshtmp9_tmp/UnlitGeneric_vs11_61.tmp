vs.1.1																								; LINEINFO(UnlitGeneric_vs11.vsh)(1)
;------------------------------------																								; LINEINFO(macros.vsh)(1)
; RULES FOR AUTHORING VERTEX SHADERS:																								; LINEINFO(macros.vsh)(2)
;------------------------------------																								; LINEINFO(macros.vsh)(3)
; - never use "def" . . .set constants in code instead. . our constant shadowing will break otherwise.																								; LINEINFO(macros.vsh)(4)
;	(same goes for pixel shaders)																								; LINEINFO(macros.vsh)(5)
; - use cN notation instead of c[N] notation. .makes grepping for registers easier.																								; LINEINFO(macros.vsh)(6)
;   The only exception is c[a0.x+blah] where you have no choice.																								; LINEINFO(macros.vsh)(7)
; NOTE: These must match the same values in vsh_prep.pl!																								; LINEINFO(macros.vsh)(10)
dcl_position v0;																								; LINEINFO(macros.vsh)(29)
dcl_normal v3;																								; LINEINFO(macros.vsh)(42)
dcl_color0 v5;																								; LINEINFO(macros.vsh)(46)
dcl_texcoord0 v7;																								; LINEINFO(macros.vsh)(54)
; NOTE: These must match the same values in vsh_prep.pl!																								; LINEINFO(macros.vsh)(111)
; currently unused																								; LINEINFO(macros.vsh)(122)
; c12, c13																								; LINEINFO(macros.vsh)(123)
; c14 is c14																								; LINEINFO(macros.vsh)(174)
; c15 is c15																								; LINEINFO(macros.vsh)(175)
; There are 16 model matrices for skinning																								; LINEINFO(macros.vsh)(177)
; NOTE: These must match the same values in vsh_prep.pl!																								; LINEINFO(macros.vsh)(178)
; pass in a reference to a var that contains a register. . ie $var where var will constain "r1", etc																								; LINEINFO(macros.vsh)(219)
;------------------------------------------------------------------------------																								; LINEINFO(macros.vsh)(472)
; Main fogging routine																								; LINEINFO(macros.vsh)(473)
;------------------------------------------------------------------------------																								; LINEINFO(macros.vsh)(474)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(3)
;	 c38-c39 = Base texture transform																								; LINEINFO(UnlitGeneric_inc.vsh)(4)
;    c40-c41 = Mask texture transform																								; LINEINFO(UnlitGeneric_inc.vsh)(5)
;    c42-c43 = Detail texture transform																								; LINEINFO(UnlitGeneric_inc.vsh)(6)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(7)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(20)
; Vertex blending																								; LINEINFO(UnlitGeneric_inc.vsh)(21)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(22)
; AllocateRegister $worldPos = r0																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; AllocateRegister $worldNormal = r1																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
;																								; LINEINFO(macros.vsh)(714)
; 0 bone skinning (13 instructions)																								; LINEINFO(macros.vsh)(715)
;																								; LINEINFO(macros.vsh)(716)
; Transform position + normal + tangentS + tangentT into world space																								; LINEINFO(macros.vsh)(717)
; position																								; LINEINFO(macros.vsh)(718)
dp4 r0.x, v0, c48																								; LINEINFO(macros.vsh)(719)
dp4 r0.y, v0, c49																								; LINEINFO(macros.vsh)(720)
dp4 r0.z, v0, c50																								; LINEINFO(macros.vsh)(721)
mov r0.w, c0.y																								; LINEINFO(macros.vsh)(722)
; normal																								; LINEINFO(macros.vsh)(723)
dp3 r1.x, v3, c48																								; LINEINFO(macros.vsh)(724)
dp3 r1.y, v3, c49																								; LINEINFO(macros.vsh)(725)
dp3 r1.z, v3, c50																								; LINEINFO(macros.vsh)(726)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(34)
; Transform the position from world to proj space																								; LINEINFO(UnlitGeneric_inc.vsh)(35)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(36)
; AllocateRegister $projPos = r2																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $projPos = r2																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
dp4 r2.x, r0, c8																								; LINEINFO(UnlitGeneric_inc.vsh)(40)
dp4 r2.y, r0, c9																								; LINEINFO(UnlitGeneric_inc.vsh)(41)
dp4 r2.z, r0, c10																								; LINEINFO(UnlitGeneric_inc.vsh)(42)
dp4 r2.w, r0, c11																								; LINEINFO(UnlitGeneric_inc.vsh)(43)
mov oPos, r2																								; LINEINFO(UnlitGeneric_inc.vsh)(44)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(46)
; Fog																								; LINEINFO(UnlitGeneric_inc.vsh)(47)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(48)
; CalcFog																								; LINEINFO(macros.vsh)(493)
; oFog.x = 1.0f = no fog																								; LINEINFO(macros.vsh)(413)
; oFog.x = 0.0f = full fog																								; LINEINFO(macros.vsh)(414)
; only r0.z is used out of worldPos																								; LINEINFO(macros.vsh)(416)
; AllocateRegister $tmp = r3																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $projPos = r2																								; LINEINFO(macros.vsh)(191)
; $tmp = r3																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; This is simple similar triangles. Imagine a line passing from the point directly vertically																								; LINEINFO(macros.vsh)(429)
; and another line passing from the point to the eye position.																								; LINEINFO(macros.vsh)(430)
; Let d = total distance from point to the eye																								; LINEINFO(macros.vsh)(431)
; Let h = vertical distance from the point to the eye																								; LINEINFO(macros.vsh)(432)
; Let hw = vertical distance from the point to the water surface																								; LINEINFO(macros.vsh)(433)
; Let dw = distance from the point to a point on the water surface that lies along the ray from point to eye																								; LINEINFO(macros.vsh)(434)
; Therefore d/h = dw/hw by similar triangles, or dw = d * hw / h.																								; LINEINFO(macros.vsh)(435)
; d = projPos.w, h = eyepos.z - worldPos.z, hw = waterheight.z - worldPos.z, dw = what we solve for																								; LINEINFO(macros.vsh)(436)
; Now, tmp.x = hw, and tmp.y = h																								; LINEINFO(macros.vsh)(438)
add r3.xy, c2.wz, -r0.z																								; LINEINFO(macros.vsh)(439)
; if r3.x < 0, then set it to 0																								; LINEINFO(macros.vsh)(441)
; This is the equivalent of moving the vert to the water surface if it's above the water surface																								; LINEINFO(macros.vsh)(442)
max r3.x, r3.x, c0.x																								; LINEINFO(macros.vsh)(443)
; Now we have 1/h																								; LINEINFO(macros.vsh)(445)
rcp r3.z, r3.y																								; LINEINFO(macros.vsh)(446)
; Now we have d/h																								; LINEINFO(macros.vsh)(448)
mul r3.w, r2.w, r3.z																								; LINEINFO(macros.vsh)(449)
; We finally have d * hw / h																								; LINEINFO(macros.vsh)(451)
; r3.w is now the distance that we see through water.																								; LINEINFO(macros.vsh)(452)
mul r3.w, r3.x, r3.w																								; LINEINFO(macros.vsh)(453)
mad r3, -r3.w, c16.w, c16.y																								; LINEINFO(macros.vsh)(457)
min r3, r3, c0.y																								; LINEINFO(macros.vsh)(458)
max oFog, r3.x, c0.x																								; LINEINFO(macros.vsh)(459)
; FreeRegister $tmp = r3																								; LINEINFO(macros.vsh)(224)
;	if( $tmp ne g_allocatedname[r3] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r3																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $tmp																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $projPos = r2																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; FreeRegister $projPos = r2																								; LINEINFO(macros.vsh)(224)
;	if( $projPos ne g_allocatedname[r2] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r2																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $projPos																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(57)
; Texture coordinates (use world-space normal for envmap, tex transform for mask)																								; LINEINFO(UnlitGeneric_inc.vsh)(58)
;------------------------------------------------------------------------------																								; LINEINFO(UnlitGeneric_inc.vsh)(59)
dp4 oT0.x, v7, c38																								; LINEINFO(UnlitGeneric_inc.vsh)(60)
dp4 oT0.y, v7, c39																								; LINEINFO(UnlitGeneric_inc.vsh)(61)
; AllocateRegister $reflectionVector = r2																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; AllocateRegister $vertToEye = r3																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
; $vertToEye = r3																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; AllocateRegister $tmp = r4																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
; $vertToEye = r3																								; LINEINFO(macros.vsh)(191)
; $tmp = r4																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; compute reflection vector r = 2 * (n dot v) n - v																								; LINEINFO(macros.vsh)(583)
sub r3.xyz, c2.xyz, r0  ;  = v = c - p																								; LINEINFO(macros.vsh)(584)
dp3 r4, r1, r3			; r4 = n dot v																								; LINEINFO(macros.vsh)(585)
mul r4.xyz, r4.xyz, r1	; r4 = (n dot v ) n																								; LINEINFO(macros.vsh)(586)
mad r2.xyz, r4, c0.z, -r3																								; LINEINFO(macros.vsh)(587)
; FreeRegister $vertToEye = r3																								; LINEINFO(macros.vsh)(224)
;	if( $vertToEye ne g_allocatedname[r3] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r3																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $vertToEye																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
; $tmp = r4																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; FreeRegister $tmp = r4																								; LINEINFO(macros.vsh)(224)
;	if( $tmp ne g_allocatedname[r4] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r4																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $tmp																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; AllocateRegister $tmp = r3																								; LINEINFO(macros.vsh)(208)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
; $tmp = r3																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; transform reflection vector into view space																								; LINEINFO(macros.vsh)(600)
dp3 r3.x, r2, c17																								; LINEINFO(macros.vsh)(601)
dp3 r3.y, r2, c18																								; LINEINFO(macros.vsh)(602)
dp3 r3.z, r2, c19																								; LINEINFO(macros.vsh)(603)
; generate <rx ry rz+1>																								; LINEINFO(macros.vsh)(605)
add r3.z, r3.z, c0.y																								; LINEINFO(macros.vsh)(606)
; find 1 / the length of r2																								; LINEINFO(macros.vsh)(608)
dp3 r3.w, r3, r3																								; LINEINFO(macros.vsh)(609)
rsq r3.w, r3.w																								; LINEINFO(macros.vsh)(610)
; r1 = r2/|r2| + 1																								; LINEINFO(macros.vsh)(612)
mad r3.xy, r3.w, r3, c0.y																								; LINEINFO(macros.vsh)(613)
mul oT1.xy, r3.xy, c0.w																								; LINEINFO(macros.vsh)(614)
; FreeRegister $tmp = r3																								; LINEINFO(macros.vsh)(224)
;	if( $tmp ne g_allocatedname[r3] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r3																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $tmp																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
; $reflectionVector = r2																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; FreeRegister $reflectionVector = r2																								; LINEINFO(macros.vsh)(224)
;	if( $reflectionVector ne g_allocatedname[r2] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r2																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $reflectionVector																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldPos = r0																								; LINEINFO(macros.vsh)(191)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; envmap mask																								; LINEINFO(UnlitGeneric_inc.vsh)(100)
dp4 oT2.x, v7, c40																								; LINEINFO(UnlitGeneric_inc.vsh)(101)
dp4 oT2.y, v7, c41																								; LINEINFO(UnlitGeneric_inc.vsh)(102)
; FreeRegister $worldPos = r0																								; LINEINFO(macros.vsh)(224)
;	if( $worldPos ne g_allocatedname[r0] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r0																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $worldPos																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
; $worldNormal = r1																								; LINEINFO(macros.vsh)(191)
;																								; LINEINFO(macros.vsh)(194)
; FreeRegister $worldNormal = r1																								; LINEINFO(macros.vsh)(224)
;	if( $worldNormal ne g_allocatedname[r1] )																								; LINEINFO(macros.vsh)(232)
;	{																								; LINEINFO(macros.vsh)(233)
;		; Error freeing r1																								; LINEINFO(macros.vsh)(234)
;		mov compileerror, freed unallocated register $worldNormal																								; LINEINFO(macros.vsh)(235)
;	}																								; LINEINFO(macros.vsh)(236)
; USED REGISTERS																								; LINEINFO(macros.vsh)(186)
;																								; LINEINFO(macros.vsh)(194)
dp4 oT3.x, v7, c42																								; LINEINFO(UnlitGeneric_inc.vsh)(121)
dp4 oT3.y, v7, c43																								; LINEINFO(UnlitGeneric_inc.vsh)(122)
; Modulation color																								; LINEINFO(UnlitGeneric_inc.vsh)(134)
mul oD0, v5, c37																								; LINEINFO(UnlitGeneric_inc.vsh)(135)
